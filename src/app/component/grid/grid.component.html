<svg id="canvas" display="block" width="100%" height="100%" (wheel)="scrollGrid($event)" (mouseup)="mouseUp()">
  <g id="transformMatrixGrid" (contextmenu)="contextMenu($event, 'grid'); false"
     (click)="disappearContext()" (mousedown)="mouseDown($event, 'grid')"
     (mousemove)="mouseMove($event, 'grid')">
    <defs>
      <pattern id="smallGrid" width="10" height="10" patternUnits="userSpaceOnUse">
        <path d="M 10 0 L 0 0 0 10" fill="none" stroke="gray" stroke-width="0.5" />
      </pattern>
      <pattern id="grid" width="50" height="50" patternUnits="userSpaceOnUse">
        <rect width="50" height="50" fill="url(#smallGrid)" />
        <path d="M 50 0 L 0 0 0 50" fill="none" stroke="black" stroke-width="1" />
      </pattern>
    </defs>
    <rect x="-5000" y="-5000" width="10000px" height="10000px" fill="url(#grid)" />
  </g>
  <g id="transformMatrix">
    <line id="yAxis" x1="0" y1="-99999" x2="0" y2="99999" style="stroke:rgb(0,0,0);stroke-width:0.04px"
          (contextmenu)="contextMenu($event, 'grid'); false"
          (click)="disappearContext()" (mousedown)="mouseDown($event, 'grid')"
          (mousemove)="mouseMove($event, 'grid')"
    />
    <line id="xAxis" x1="-99999" y1="0" x2="99999" y2="0" style="stroke:rgb(0,0,0);stroke-width:0.04px"
          (contextmenu)="contextMenu($event, 'grid'); false"
          (click)="disappearContext()" (mousedown)="mouseDown($event, 'grid')"
          (mousemove)="mouseMove($event, 'grid')"
    />
    <g id="linkageHolder" style="transform: scaleY(-1)">
      <path *ngFor="let link of links" (contextmenu)="contextMenu($event, 'link', link); false"
            (click)="disappearContext()"
            (mousedown)="mouseDown($event, 'link', link)"
            (mousemove)="mouseMove($event, 'link')"
            [attr.d]="link.d" [attr.id]="link.id" [attr.fill]="link.fill" style="opacity: 0.8"></path>
      <!-- SVG for creating Joints -->
      <svg *ngFor="let joint of joints" (contextmenu)="contextMenu($event, 'joint', joint); false"
           (click)="disappearContext()" [attr.x]="joint.x" [attr.y]="joint.y"
           (mousedown)="mouseDown($event, 'joint', joint)"
           (mousemove)="mouseMove($event, 'joint')"
           width="10" height="10" style="overflow: visible" cursor="move">
        <!-- condition with regular revolute joint -->
        <circle *ngIf="joint.ground === false && joint.type !== 'P'" id="joint_{{joint.id}}_ring"
                [attr.r]="(joint.r * 7 / 5)" [attr.cx]="0" [attr.cy]="0" fill="black"/>
        <circle *ngIf="joint.ground === false && joint.type !== 'P'" id="joint_{{joint.id}}"
                [attr.r]="joint.r" [attr.cx]="0" [attr.cy]="0" fill="gray" stroke="#00000000"
                [attr.stroke-width]="(joint.r * 2)"/>
        <!-- condition for slider crank -->
        <circle *ngIf="joint.type === 'P'" r="0.06667" cx="0%" cy="0%" fill="black" stroke="#00000000" stroke-width="0.2"></circle>
        <path *ngIf="joint.type === 'P'" d="M -0.16 -0.16 L 0.16 -0.16 C 0.182077 -0.16 0.2 -0.142077 0.2 -0.12 L 0.2 -0.12
         L 0.2 0.12 C 0.2 0.142077 0.182077 0.16 0.16 0.16 L 0.16 0.16 L -0.16 0.16 C -0.182077 0.16 -0.2 0.142077
          -0.2 0.12 L -0.2 0.12 L -0.2 -0.12 C -0.2 -0.142077 -0.182077 -0.16 -0.16 -0.16 Z" stroke="black"
              stroke-width="0.04" fill-opacity="0"></path>
        <!-- condition for ground joint -->
        <circle *ngIf="joint.ground === true"
                r="0.06667" cx="0%" cy="0%" fill="black" stroke="#00000000" stroke-width="0.2"></circle>
        <line *ngIf="joint.ground === true"
              x1="-0.15" y1="-0.15" x2="-0.225" y2="-0.225" stroke="black" stroke-width="0.03"></line>
        <line *ngIf="joint.ground === true"
              x1="-0.075" y1="-0.15" x2="-0.15" y2="-0.225" stroke="black" stroke-width="0.03"></line>
        <line *ngIf="joint.ground === true"
              x1="0" y1="-0.15" x2="-0.075" y2="-0.225" stroke="black" stroke-width="0.03"></line>
        <line *ngIf="joint.ground === true"
              x1="0.075" y1="-0.15" x2="0" y2="-0.225" stroke="black" stroke-width="0.03"></line>
        <line *ngIf="joint.ground === true"
              x1="0.15" y1="-0.15" x2="0.075" y2="-0.225" stroke="black" stroke-width="0.03"></line>
        <line *ngIf="joint.ground === true"
              x1="0.225" y1="-0.15" x2="0.15" y2="-0.225" stroke="black" stroke-width="0.03"></line>
        <line *ngIf="joint.ground === true"
              x1="-0.3" y1="-0.15" x2="0.3" y2="-0.15" stroke="black" stroke-width="0.05"></line>
        <path *ngIf="joint.ground === true"
              d="M -0.225 -0.15 L -0.15 0.15 L 0.15 0.15 L 0.225 -0.15" stroke="black" stroke-width="0.05"
              fill="transparent"></path>
      </svg>
    </g>
    <g id="pathsHolder"></g>
    <g id="pathsPathPointHolder"></g>
    <g id="forcesHolder" style="transform: scaleY(-1)" *ngFor="let force of forces"
       (contextmenu)="contextMenu($event, 'force', force); false"
       (click)="disappearContext()">
      <g [attr.id]="force.id" (mouseover)="force.showHighlight = true" (mouseout)="force.showHighlight = false">
        <path *ngIf="force.showHighlight" [attr.d]="force.forceLine" stroke="yellow" stroke-width="0.2"></path>
        <path [attr.d]="force.forceLine" [attr.stroke]="force.stroke" stroke-width="0.04"></path>
        <path [attr.d]="force.forceArrow" [attr.fill]="force.fill"></path>
      </g>
      <svg id="startForceEndpoint" (mousedown)="mouseDown($event, 'force', force, 'startPoint')"
           (mousemove)="mouseMove($event, 'force')"
           [attr.x]="force.startCoord.x" [attr.y]="force.startCoord.y" height="10" width="10"
           style="overflow: visible; cursor: move">
        <circle cx="0%" cy="0%" r="0.1" fill="blue"></circle>
        <circle cx="0%" cy="0%" r="0.1" fill="blue"></circle>
      </svg>
      <svg id="endForceEndpoint" (mousedown)="mouseDown($event, 'force', force, 'endPoint')"
           (mousemove)="mouseMove($event, 'force')"
           [attr.x]="force.endCoord.x" [attr.y]="force.endCoord.y" height="10" width="10"
           style="overflow: visible; cursor: move">
        <circle cx="0%" cy="0%" r="0.1" fill="blue"></circle>
        <circle cx="0%" cy="0%" r="0.1" fill="blue"></circle>
      </svg>
    </g>
    <!--TODO: Add case when dragging anything above the jointTagHolder -->
    <g id="jointTagHolder">
      <svg *ngFor="let joint of joints" [attr.x]="joint.x - 0.2" [attr.y]="(-1 * joint.y) - 0.2"
           [attr.height]="10" [attr.width]="10" style="overflow: visible; text-anchor: middle">
        <text style="font-size: 0.7px; text-anchor: middle">{{joint.id}}</text>
      </svg>
    </g>
    <!--TODO: Add case when dragging anything above the linkTagHolder -->
    <g id="linkTagHolder">
      <svg *ngFor="let link of links" [attr.x]="link.CoMX" [attr.y]="link.CoMY * -1"
           [attr.height]="10" [attr.width]="10" style="overflow: visible; text-anchor: middle">
        <text style="font-size: 0.7px; text-anchor: middle">{{link.id}}</text>
      </svg>
    </g>
    <!--TODO: Add case when dragging anything above the forceTagHolder -->
    <g id="forceTagHolder">
      <svg *ngFor="let force of forces" [attr.x]="(force.startCoord.x + force.endCoord.x) / 2"
      [attr.y]="((force.startCoord.y + force.endCoord.y) / 2) * -1"
      [attr.height]="10" [attr.width]="10" style="overflow: visible; text-anchor: middle">
        <!-- should font-size have px??? -->
        <text style="font-size: 0.7px; text-anchor: middle"> {{force.id}}</text>
      </svg>
    </g>
    <!--TODO: Add case when dragging anything above the comTagHolder -->
    <g id="comTagHolder" style="transform: scaleY(-1)">
      <svg *ngFor="let link of links" style="overflow: visible" width="1.23" height="2.61">
        <path stroke-width="2" stroke-linejoin="round" fill="black" opacity="1.0"
              [attr.d]="link.CoM_d1"></path>
        <path stroke-width="2" stroke-linejoin="round" fill="white" opacity="1.0"
              [attr.d]="link.CoM_d2"></path>
        <path stroke-width="2" stroke-linejoin="round" fill="black" opacity="1.0"
              [attr.d]="link.CoM_d3"></path>
        <path stroke-width="2" stroke-linejoin="round" fill="white" opacity="1.0"
              [attr.d]="link.CoM_d4"></path>
      </svg>
    </g>
    <g id="pathPointHolder"></g>
    <g id="threePositionHolder"></g>
    <g id="jointTempHolder" style="display: none; transform: scaleY(-1)">
      <line stroke="black" stroke-width="0.02" stroke-opacity="0.5" style="pointer-events: none"></line>
      <svg height="10" width="10" style="overflow: visible" cursor="move">
        <circle r="0.14" cx="0%" cy="0%" fill="black" fill-opacity="0.5" stroke-opacity="0.5"> </circle>
        <circle r="0.1" cx="0%" cy="0%" fill="gray" stroke="#00000000" stroke-width="0.2"> </circle>
      </svg>
    </g>
    <g id="forceTempHolder" opacity="0.5" style="display: none; pointer-events: none; transform: scaleY(-1)">
      <path stroke-width="0.04" stroke="black" d=""></path>
      <path fill="black" d=""></path>
    </g>
  </g>
  <g class="context-menu-canvas" style="cursor: pointer">
    <g class="menu-entry" id="menuEntryAddLinkOnGrid" (click)="createLink($event, 'grid')"
       (mouseout)="RectMouseOut($event, 'grid')"
       (mouseover)="RectMouseOver($event, 'grid')" style="display: none">
      <rect x="400" y="400" width="120" height="20" style="fill: rgb(244, 244, 244); stroke: white; stroke-width: 1px"></rect>
      <text x="400" y="400" dx="15" dy="15" style="fill: steelblue; font-size: 13px">Add Link</text>
    </g>
  </g>
  <g class="context-menu-joint" style="cursor: pointer">
    <g class="menu-entry" id="menuEntryAddInput" (click)="createInput($event)"
       (mouseout)="RectMouseOut($event, 'addInput')"
       (mouseover)="RectMouseOver($event, 'addInput')" style="display: none">
      <rect x="400" y="400" width="120" height="20" style="fill: rgb(200, 200, 200); stroke: white; stroke-width: 1px"></rect>
      <text x="400" y="400" dx="15" dy="15" style="fill: steelblue; font-size: 13px">Add Input</text>
    </g>
    <g class="menu-entry" id="menuEntryAddLinkOnJoint" (click)="createLink($event, 'joint')"
       (mouseout)="RectMouseOut($event, 'addLink')"
       (mouseover)="RectMouseOver($event, 'addLink')" style="display: none">
      <rect x="400" y="400" width="120" height="20" style="fill: rgb(244, 244, 244); stroke: white; stroke-width: 1px"></rect>
      <text x="400" y="400" dx="15" dy="15" style="fill: steelblue; font-size: 13px">Add Link</text>
    </g>
    <g class="menu-entry" id="menuEntryCreateGround" (click)="createGround()"
       (mouseout)="RectMouseOut($event, 'addGround')"
       (mouseover)="RectMouseOver($event, 'addGround')" style="display: none">
      <rect x="400" y="400" width="120" height="20" style="fill: rgb(244, 244, 244); stroke: white; stroke-width: 1px"></rect>
      <text x="400" y="400" dx="15" dy="15" style="fill: steelblue; font-size: 13px">Create Ground</text>
    </g>
    <g class="menu-entry" id="menuEntryCreateSlider" (click)="createSlider()"
       (mouseout)="RectMouseOut($event, 'addSlider')"
       (mouseover)="RectMouseOver($event, 'addSlider')" style="display: none">
      <rect x="400" y="400" width="120" height="20" style="fill: rgb(244, 244, 244); stroke: white; stroke-width: 1px"></rect>
      <text x="400" y="400" dx="15" dy="15" style="fill: steelblue; font-size: 13px">Create Slider</text>
    </g>
    <g class="menu-entry" id="menuEntryDeleteJoint" (click)="deleteJoint()"
       (mouseout)="RectMouseOut($event, 'deleteJoint')"
       (mouseover)="RectMouseOver($event, 'deleteJoint')" style="display: none">
      <rect x="400" y="400" width="120" height="20" style="fill: rgb(244, 244, 244); stroke: white; stroke-width: 1px"></rect>
      <text x="400" y="400" dx="15" dy="15" style="fill: steelblue; font-size: 13px">Delete Joint</text>
    </g>
  </g>
  <g class="context-menu-link" style="cursor:pointer">
    <g class="menu-entry" id="menuEntryAddLinkOnLink" (click)="createLink($event, 'link')"
       (mouseout)="RectMouseOut($event, 'addLink')"
       (mouseover)="RectMouseOver($event, 'addLink')" style="display: none">
      <rect x="400" y="400" width="120" height="20" style="fill: rgb(244, 244, 244); stroke: white; stroke-width: 1px"></rect>
      <text x="400" y="400" dx="15" dy="15" style="fill: steelblue; font-size: 13px">Attach Link</text>
    </g>
    <g class="menu-entry" id="menuEntryAddForce" (click)="createForce($event)"
       (mouseout)="RectMouseOut($event, 'addForce')"
       (mouseover)="RectMouseOver($event, 'addForce')" style="display:none;">
      <rect x="400" y="400" width="120" height="20" style="fill: rgb(244, 244, 244); stroke: white; stroke-width: 1px"></rect>
      <text x="400" y="400" dx="15" dy="15" style="fill: steelblue; font-size: 13px">Attach Force</text>
    </g>
    <g class="menu-entry" id="menuEntryAddTracerPoint" (click)="addJoint()"
       (mouseout)="RectMouseOut($event, 'addTracer')"
       (mouseover)="RectMouseOver($event, 'addTracer')" style="display: none">
      <rect x="400" y="400" width="120" height="20" style="fill: rgb(244, 244, 244); stroke: white; stroke-width: 1px"></rect>
      <text x="400" y="400" dx="15" dy="15" style="fill: steelblue; font-size: 13px">Attach Tracer Point</text>
    </g>
    <g class="menu-entry" id="menuEntryEditShape" (click)="editShape()"
       (mouseout)="RectMouseOut($event, 'editShape')"
       (mouseover)="RectMouseOver($event, 'editShape')" style="display: none">
      <rect x="400" y="400" width="120" height="20" style="fill: rgb(244, 244, 244); stroke: white; stroke-width: 1px"></rect>
      <text x="400" y="400" dx="15" dy="15" style="fill: steelblue; font-size: 13px">Edit Shape</text>
    </g>
    <g class="menu-entry" id="menuEntryDeleteLink" (click)="deleteLink()"
       (mouseout)="RectMouseOut($event, 'deleteLink')"
       (mouseover)="RectMouseOver($event, 'deleteLink')" style="display: none">
      <rect x="400" y="400" width="120" height="20" style="fill: rgb(244, 244, 244); stroke: white; stroke-width: 1px"></rect>
      <text x="400" y="400" dx="15" dy="15" style="fill: steelblue; font-size: 13px">Delete Link</text>
    </g>
  </g>
  <g class="context-menu-force" style="cursor: pointer">
    <g class="menu-entry" id="menuEntryChangeForceDirection" (click)="changeForceDirection()"
       (mouseout)="RectMouseOut($event, 'changeForceDirection')"
       (mouseover)="RectMouseOver($event, 'changeForceDirection')" style="display: none">
      <rect x="400" y="400" width="120" height="20" style="fill: rgb(244, 244, 244); stroke: white; stroke-width: 1px"></rect>
      <text x="400" y="400" dx="15" dy="15" style="fill: steelblue; font-size: 13px">Switch Force Direction</text>
    </g>
    <g class="menu-entry" id="menuEntryChangeForceLocal" (click)="changeForceLocal()"
       (mouseout)="RectMouseOut($event, 'changeForceLocal')"
       (mouseover)="RectMouseOver($event, 'changeForceLocal')" style="display: none">
      <rect x="400" y="400" width="120" height="20" style="fill: rgb(244, 244, 244); stroke: white; stroke-width: 1px"></rect>
      <text x="400" y="400" dx="15" dy="15" style="fill: steelblue; font-size: 13px">Change Force Local</text>
    </g>
    <g class="menu-entry" id="menuEntryDeleteForce" (click)="deleteForce()"
       (mouseout)="RectMouseOut($event, 'deleteForce')"
       (mouseover)="RectMouseOver($event, 'deleteForce')" style="display: none">
      <rect x="400" y="400" width="120" height="20" style="fill: rgb(244, 244, 244); stroke: white; stroke-width: 1px"></rect>
      <text x="400" y="400" dx="15" dy="15" style="fill: steelblue; font-size: 13px">Delete Force</text>
    </g>
  </g>
</svg>
