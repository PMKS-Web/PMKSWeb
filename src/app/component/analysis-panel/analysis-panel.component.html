<div id='analysisWrapper'>
  <!-- 
    //Param 1: analysis: "force","stress","kinematic"

    //Param 2: analysisType: IF analysis == force: "statics","dynamic"
    //Param 2: analysisType: IF analysis == kinematic: "loop","ic"

    //Param 3: mechProp: IF analysis == force: "Input Torque","Joint Forces"
    //Param 3: mechProp: IF analysis == kinematic: "Linear Joint Pos","Linear Joint Vel","Linear Joint Acc",
    //"Linear Link's CoM Pos","Linear Link's CoM Vel","Linear Link's CoM Acc",
    //"Angular Link Pos","Angular Link Vel",Angular Link Acc"

    //Param 4: mechPart: If Joint 'a','b','c'... If Link 'ab','bc','cd'... 
  -->

  <!-- Invalid Mech-->
  <panel-section id='placeholderContainer' *ngIf='!validMechanisms()'>
    <p id='placeholderText'>
      This linkage is not valid. It could be missing an input or have too many / little DOfs.
    </p>
    <img id='placeholder' src='assets/placeholder.svg' />
  </panel-section>

  <!-- Valid Mech but Nothing Selected -->
  <panel-section
    id='placeholderContainer'
    *ngIf="validMechanisms() && this.activeSrv.objType == 'Nothing'"
  >
    <p id='placeholderText'>Select a part of the linkage to analyze it.</p>
    <img id='placeholder' src='assets/placeholder.svg' />
  </panel-section>

  <!-- Joint Kinematics-->
  <panel-section-collapsible
    id='analysis-panel'
    *ngIf="validMechanisms() && this.activeSrv.objType == 'Joint'"
    [expanded]="graphExpanded['JKineAna']"
    (opened)="graphExpanded['JKineAna'] = true"
    (closed)="graphExpanded['JKineAna'] = false"
  >
    <title-block alwaysShown icon='expand_less'>
      Kinematic Analysis for {{ this.activeSrv.objType }}
      {{ this.activeSrv.selectedJoint.id | uppercase }}
    </title-block>

    <mat-expansion-panel
      [expanded]="graphExpanded['JPos']"
      (opened)="graphExpanded['JPos'] = true"
      (closed)="graphExpanded['Jpos'] = false"
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          Position of Joint {{ this.activeSrv.selectedJoint.id | uppercase }}
        </mat-panel-title>
        <mat-panel-description>
          <mat-icon
            matTooltip='The X and Y position of the selected joint graphed over time'
            [matTooltipShowDelay]='1000'
            id='graph-help'
          >help_outline
          </mat-icon
          >
        </mat-panel-description>
      </mat-expansion-panel-header>
      <app-analysis-graph
        analysis='kinematic'
        analysisType='loop'
        mechProp='Linear Joint Pos'
        mechPart='{{ this.activeSrv.selectedJoint.id }}'
      ></app-analysis-graph>
    </mat-expansion-panel>

    <mat-expansion-panel
      [expanded]="graphExpanded['JVel']"
      (opened)="graphExpanded['JVel'] = true"
      (closed)="graphExpanded['JVel'] = false"
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          Velocity of Joint {{ this.activeSrv.selectedJoint.id | uppercase }}
        </mat-panel-title>
        <mat-panel-description>
          <mat-icon
            matTooltip='The velocity of the selected joint graphed'
            [matTooltipShowDelay]='1000'
            id='graph-help'
          >help_outline
          </mat-icon
          >
        </mat-panel-description>
      </mat-expansion-panel-header>
      <app-analysis-graph
        analysis='kinematic'
        analysisType='loop'
        mechProp='Linear Joint Vel'
        mechPart='{{ this.activeSrv.selectedJoint.id }}'
      ></app-analysis-graph>
    </mat-expansion-panel>

    <mat-expansion-panel
      [expanded]="graphExpanded['JAcc']"
      (opened)="graphExpanded['JAcc'] = true"
      (closed)="graphExpanded['JAcc'] = false"
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          Acceleration of Joint {{ this.activeSrv.selectedJoint.id | uppercase }}
        </mat-panel-title>
        <mat-panel-description>
          <mat-icon
            matTooltip='The acceleration of the selected joint graphed'
            [matTooltipShowDelay]='1000'
            id='graph-help'
          >help_outline
          </mat-icon
          >
        </mat-panel-description>
      </mat-expansion-panel-header>
      <app-analysis-graph
        analysis='kinematic'
        analysisType='loop'
        mechProp='Linear Joint Acc'
        mechPart='{{ this.activeSrv.selectedJoint.id }}'
      ></app-analysis-graph>
    </mat-expansion-panel>
  </panel-section-collapsible>

  <!-- Joint Forces-->
  <panel-section-collapsible
    [expanded]="graphExpanded['JForceAna']"
    (opened)="graphExpanded['JForceAna'] = true"
    (closed)="graphExpanded['JForceAna'] = false"
    id='analysis-panel'
    *ngIf="validMechanisms() && this.activeSrv.objType == 'Joint'"
  >
    <title-block alwaysShown icon='expand_less'>
      Force Analysis for {{ this.activeSrv.objType }}
      {{ this.activeSrv.selectedJoint.id | uppercase }}
    </title-block>

    <radio-block
      tooltip='Determines whether the force analysis is done at static equilibrium or under dynamics conditions. For dynamics, the global animation speed can be used, or a custom speed can be set by selecting other.'
      option1='Global (20 rpm)'
      option2='Equilibrium (0 rpm)'
      option3='Other'
      [formGroup]='this.inputSpeedFormGroup'
      _formControl='speed'
    >Input Speed
    </radio-block
    >

    <mat-expansion-panel
      [expanded]="graphExpanded['JForce']"
      (opened)="graphExpanded['JForce'] = true"
      (closed)="graphExpanded['JForce'] = false"
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          Force on Joint {{ this.activeSrv.selectedJoint.id | uppercase }}
        </mat-panel-title>
        <mat-panel-description>
          <mat-icon
            matTooltip='The force applied at the selected joint graphed over time'
            [matTooltipShowDelay]='1000'
            id='graph-help'
          >help_outline
          </mat-icon
          >
        </mat-panel-description>
      </mat-expansion-panel-header>
      <app-analysis-graph
        analysis='force'
        analysisType="{{ this.inputSpeedFormGroup.value.speed === 'One' ? 'dynamic' : 'static' }}"
        mechProp='Joint Forces'
        mechPart='{{ this.activeSrv.selectedJoint.id }}'
      ></app-analysis-graph>
    </mat-expansion-panel>

    <mat-expansion-panel
      *ngIf='this.activeSrv.selectedJoint.input'
      [expanded]="graphExpanded['JInputForce']"
      (opened)="graphExpanded['JInputForce'] = true"
      (closed)="graphExpanded['JInputForce'] = false"
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          Input Torque at Joint {{ this.activeSrv.selectedJoint.id | uppercase }}
        </mat-panel-title>
        <mat-panel-description>
          <mat-icon
            matTooltip='The toque applied to the mechanism by the input joint graphed over time. Only available if the selected joint is grounded and is an input.'
            [matTooltipShowDelay]='1000'
            id='graph-help'
          >help_outline
          </mat-icon
          >
        </mat-panel-description>
      </mat-expansion-panel-header>
      <app-analysis-graph
        analysis='force'
        analysisType="{{ this.inputSpeedFormGroup.value.speed === 'One' ? 'dynamic' : 'static' }}"
        mechProp='Input Torque'
        mechPart='{{ this.activeSrv.selectedJoint.id }}'
      ></app-analysis-graph>
    </mat-expansion-panel>
  </panel-section-collapsible>

  <!-- Link Kinematics-->
  <panel-section-collapsible
    [expanded]="graphExpanded['LKineAna']"
    (opened)="graphExpanded['LKineAna'] = true"
    (closed)="graphExpanded['LKineAna'] = false"
    id='analysis-panel'
    *ngIf="validMechanisms() && this.activeSrv.objType == 'Link'"
  >
    <title-block alwaysShown icon='expand_less'>
      Kinematic Analysis for {{ this.activeSrv.objType }} {{ this.activeSrv.selectedLink.id | uppercase }}
    </title-block>

    <!-- <subtitle-block>Kinematics</subtitle-block> -->

    <!-- 
    //Param 1: analysis: "force","stress","kinematic"

    //Param 2: analysisType: IF analysis == force: "statics","dynamic"
    //Param 2: analysisType: IF analysis == kinematic: "loop","ic"

    //Param 3: mechProp: IF analysis == force: "Input Torque","Joint Forces"
    //Param 3: mechProp: IF analysis == kinematic: "Linear Joint Pos","Linear Joint Vel","Linear Joint Acc",
    //"Linear Link's CoM Pos","Linear Link's CoM Vel","Linear Link's CoM Acc",
    //"Angular Link Pos","Angular Link Vel",Angular Link Acc"

    //Param 4: mechPart: If Joint 'a','b','c'... If Link 'ab','bc','cd'... 
  -->

    <mat-expansion-panel
      [expanded]="graphExpanded['LAng']"
      (opened)="graphExpanded['LAng'] = true"
      (closed)="graphExpanded['LAng'] = false"
    >
      <mat-expansion-panel-header>
        <mat-panel-title> Angle of Link {{ this.activeSrv.selectedLink.id | uppercase }} </mat-panel-title>
        <mat-panel-description>
          <mat-icon
            matTooltip='The angle of the selected above the horizontal of the link graphed over time'
            [matTooltipShowDelay]='1000'
            id='graph-help'
          >help_outline
          </mat-icon
          >
        </mat-panel-description>
      </mat-expansion-panel-header>
      <app-analysis-graph
        analysis='kinematic'
        analysisType='loop'
        mechProp='Angular Link Pos'
        mechPart='{{ this.activeSrv.selectedLink.id }}'
      ></app-analysis-graph>
    </mat-expansion-panel>

    <mat-expansion-panel
      [expanded]="graphExpanded['LAngVel']"
      (opened)="graphExpanded['LAngVel'] = true"
      (closed)="graphExpanded['LAngVel'] = false"
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-panel-title>
            Angular Velocity of Link {{ this.activeSrv.selectedLink.id | uppercase }}
          </mat-panel-title>
        </mat-panel-title>
        <mat-panel-description>
          <mat-icon
            matTooltip='The angular velocity of the selected link graphed'
            [matTooltipShowDelay]='1000'
            id='graph-help'
          >help_outline
          </mat-icon
          >
        </mat-panel-description>
      </mat-expansion-panel-header>
      <app-analysis-graph
        analysis='kinematic'
        analysisType='loop'
        mechProp='Angular Link Vel'
        mechPart='{{ this.activeSrv.selectedLink.id }}'
      ></app-analysis-graph>
    </mat-expansion-panel>

    <mat-expansion-panel
      [expanded]="graphExpanded['LAngAcc']"
      (opened)="graphExpanded['LAngAcc'] = true"
      (closed)="graphExpanded['LAngAcc'] = false"
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-panel-title>
            Angular Acceleration of Link {{ this.activeSrv.selectedLink.id | uppercase }}
          </mat-panel-title>
        </mat-panel-title>
        <mat-panel-description>
          <mat-icon
            matTooltip='The angular acceleration of the selected link graphed'
            [matTooltipShowDelay]='1000'
            id='graph-help'
          >help_outline
          </mat-icon
          >
        </mat-panel-description>
      </mat-expansion-panel-header>
      <app-analysis-graph
        analysis='kinematic'
        analysisType='loop'
        mechProp='Angular Link Acc'
        mechPart='{{ this.activeSrv.selectedLink.id }}'
      ></app-analysis-graph>
    </mat-expansion-panel>

    <subtitle-block style='margin-top: 20px'
    >Center of Mass (COM) of Link {{ this.activeSrv.selectedLink.id | uppercase }}</subtitle-block
    >

    <mat-expansion-panel
      [expanded]="graphExpanded['LPos']"
      (opened)="graphExpanded['LPos'] = true"
      (closed)="graphExpanded['LPos'] = false"
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-panel-title>
            Position of Link {{ this.activeSrv.selectedLink.id | uppercase }}'s COM
          </mat-panel-title>
        </mat-panel-title>
        <mat-panel-description>
          <mat-icon
            matTooltip="The position of the selected link's COM graphed"
            [matTooltipShowDelay]='1000'
            id='graph-help'
          >help_outline
          </mat-icon
          >
        </mat-panel-description>
      </mat-expansion-panel-header>
      <app-analysis-graph
        analysis='kinematic'
        analysisType='loop'
        mechProp="Linear Link's CoM Pos"
        mechPart='{{ this.activeSrv.selectedLink.id }}'
      ></app-analysis-graph>
    </mat-expansion-panel>

    <mat-expansion-panel
      [expanded]="graphExpanded['LVel']"
      (opened)="graphExpanded['LVel'] = true"
      (closed)="graphExpanded['LVel'] = false"
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-panel-title>
            Velocity of Link {{ this.activeSrv.selectedLink.id | uppercase }}'s COM
          </mat-panel-title>
        </mat-panel-title>
        <mat-panel-description>
          <mat-icon
            matTooltip="The velocity of the selected link's COM graphed"
            [matTooltipShowDelay]='1000'
            id='graph-help'
          >help_outline
          </mat-icon
          >
        </mat-panel-description>
      </mat-expansion-panel-header>
      <app-analysis-graph
        analysis='kinematic'
        analysisType='loop'
        mechProp="Linear Link's CoM Vel"
        mechPart='{{ this.activeSrv.selectedLink.id }}'
      ></app-analysis-graph>
    </mat-expansion-panel>

    <mat-expansion-panel
      [expanded]="graphExpanded['LAcc']"
      (opened)="graphExpanded['LAcc'] = true"
      (closed)="graphExpanded['LAcc'] = false"
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          <mat-panel-title>
            Acceleration of Link {{ this.activeSrv.selectedLink.id | uppercase }}'s COM
          </mat-panel-title>
        </mat-panel-title>
        <mat-panel-description>
          <mat-icon
            matTooltip="The acceleration of the selected link's COM graphed"
            [matTooltipShowDelay]='1000'
            id='graph-help'
          >help_outline
          </mat-icon
          >
        </mat-panel-description>
      </mat-expansion-panel-header>
      <app-analysis-graph
        analysis='kinematic'
        analysisType='loop'
        mechProp="Linear Link's CoM Acc"
        mechPart='{{ this.activeSrv.selectedLink.id }}'
      ></app-analysis-graph>
    </mat-expansion-panel>
  </panel-section-collapsible>

  <!-- Link Forces-->
  <panel-section-collapsible
    [expanded]="graphExpanded['LForceAna']"
    (opened)="graphExpanded['LForceAna'] = true"
    (closed)="graphExpanded['LForceAna'] = false"
    id='analysis-panel'
    *ngIf="validMechanisms() && this.activeSrv.objType == 'Link'"
  >
    <title-block alwaysShown icon='expand_less'>
      Force Analysis for {{ this.activeSrv.objType }}
      {{ this.activeSrv.selectedLink.id | uppercase }}
    </title-block>

    <radio-block
      tooltip='Determines whether the force analysis is done at static equilibrium or under dynamics conditions. For dynamics, the global animation speed can be used, or a custom speed can be set by selecting other.'
      option1='Global (20 rpm)'
      option2='Equilibrium (0 rpm)'
      option3='Other'
      [formGroup]='this.inputSpeedFormGroup'
      _formControl='speed'
    >Input Speed
    </radio-block
    >

    <mat-expansion-panel
      [expanded]="graphExpanded['LForce']"
      (opened)="graphExpanded['LForce'] = true"
      (closed)="graphExpanded['LForce'] = false"
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          Axial Force on Link {{ this.activeSrv.selectedLink.id | uppercase }}
        </mat-panel-title>
        <mat-panel-description>
          <mat-icon
            matTooltip="The axial force applied at the selected link's cross section graphed over time"
            [matTooltipShowDelay]='1000'
            id='graph-help'
          >help_outline
          </mat-icon
          >
        </mat-panel-description>
      </mat-expansion-panel-header>
      This feature is not available yet
      <!-- <app-analysis-graph
      analysis="force"
      analysisType="{{ this.inputSpeedFormGroup.value.speed === 'One' ? 'dynamic' : 'static' }}"
      mechProp="Joint Forces"
      mechPart="{{ this.activeSrv.Joint.id }}"
    ></app-analysis-graph> -->
    </mat-expansion-panel>

    <mat-expansion-panel
      [expanded]="graphExpanded['LStress']"
      (opened)="graphExpanded['LStress'] = true"
      (closed)="graphExpanded['LStress'] = false"
    >
      <mat-expansion-panel-header>
        <mat-panel-title>
          Axial Stress on Link {{ this.activeSrv.selectedLink.id | uppercase }}
        </mat-panel-title>
        <mat-panel-description>
          <mat-icon
            matTooltip="The axial stress applied at the selected link's minimum cross section graphed over time"
            [matTooltipShowDelay]='1000'
            id='graph-help'
          >help_outline
          </mat-icon
          >
        </mat-panel-description>
      </mat-expansion-panel-header>
      This feature is not available yet
      <!-- <app-analysis-graph
      analysis="force"
      analysisType="{{ this.inputSpeedFormGroup.value.speed === 'One' ? 'dynamic' : 'static' }}"
      mechProp="Input Torque"
      mechPart="{{ this.activeSrv.Joint.id }}"
    ></app-analysis-graph> -->
    </mat-expansion-panel>
  </panel-section-collapsible>

  <!-- Export Button -->
  <panel-section>
    <button-block icon='download'> Export Analysis for {{ this.activeSrv.objType }} </button-block>
  </panel-section>
</div>
